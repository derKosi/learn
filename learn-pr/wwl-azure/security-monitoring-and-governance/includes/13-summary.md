Organizations implementing DevSecOps practices require comprehensive security monitoring and governance spanning entire software development lifecycle from source code through production deployments. This module explored security capabilities protecting Azure DevOps pipelines, cloud infrastructure, identities, and source code repositories through Microsoft Defender for Cloud, Azure Policy, resource locks, Microsoft Defender for Identity, and GitHub Advanced Security integration.

## Key takeaways

**Pipeline security:**

Implementing pipeline security requires multilayered approach protecting secrets, service connections, agents, and deployment processes. Azure Key Vault integration provides centralized secrets management eliminating hardcoded credentials. Service connections with managed identities enable passwordless authentication to Azure resources. Pipeline permissions and role-based access control (RBAC) enforce least privilege principles. Microsoft-hosted agents provide secure, isolated build environments while self-hosted agents require hardening with network isolation, patched operating systems, and regular security updates. Deployment gates, approvals, and audit logging create governance controls ensuring changes reviewed before production deployment. Multifactor authentication (MFA), Conditional Access, and Privileged Identity Management (PIM) secure administrator access. Dynamic Application Security Testing (DAST) tools like OWASP ZAP integrated into pipelines detect runtime vulnerabilities before deployment.

**Microsoft Defender for Cloud:**

Microsoft Defender for Cloud delivers unified security management across multicloud and hybrid environments through Cloud Security Posture Management (CSPM) and Cloud Workload Protection (CWP) capabilities. Foundational CSPM provides free configuration security assessments and recommendations. Defender plans (Servers, Containers, App Service, Storage, SQL, Key Vault, Resource Manager) provide runtime threat protection with advanced threat detection, vulnerability management, just-in-time VM access, and adaptive application controls. Secure Score quantifies security posture improvement progress tracking remediation efforts. Security recommendations provide actionable guidance with manual fixes, quick fixes, and Azure Policy-driven automatic remediation. Security alerts detect threats with investigation workflows, entity timelines, and automated response capabilities. Regulatory compliance dashboard tracks compliance with standards including PCI DSS, ISO 27001, HIPAA, SOC 2 with continuous assessment and audit-ready reporting. Organizations integrate Defender for Cloud into DevSecOps pipelines scanning Infrastructure as Code (IaC) during development preventing misconfigurations reaching production.

**Azure Policy governance:**

Azure Policy enables policy-as-code governance automating compliance enforcement across Azure resources at scale. Policy definitions specify compliance requirements through declarative JSON with conditions and effects. Policy effects control enforcement behavior: **Deny** blocks non-compliant deployments, **Audit** logs compliance violations without blocking, **DeployIfNotExists** automatically deploys missing configurations (diagnostic settings, agents, encryption), **Modify** updates resource properties to achieve compliance, **AuditIfNotExists** detects missing related resources. Policy assignments apply policies at management group, subscription, resource group, or resource scopes with inheritance and exemptions. Built-in policies address common scenarios: region restrictions, required tagging, virtual machine SKU restrictions, encryption requirements, diagnostic logging enforcement. Policy compliance dashboard tracks compliance states (Compliant, Non-compliant, Conflicting, Not Started, Exempt) across thousands of resources. Remediation tasks correct existing non-compliant resources after policy assignment. Organizations integrate policies into CI/CD pipelines with `az policy` CLI commands and GitHub Actions validating Infrastructure as Code templates before deployment preventing compliance violations. Custom policies address organization-specific requirements with parameters enabling reusable, flexible policy definitions.

**Policy initiatives:**

Policy initiatives bundle related policies into compliance frameworks simplifying assignment and compliance tracking. Built-in initiatives represent regulatory standards: Azure Security Benchmark (100+ policies covering compute, networking, data, identity, security operations), PCI DSS 3.2.1 (payment card industry requirements), ISO 27001 (information security controls), HIPAA (healthcare data protection), NIST SP 800-53 (federal information system controls). Initiative compliance dashboards aggregate policy compliance providing holistic view of compliance posture with drill-down capabilities to individual policies and resources. Custom initiatives group organization-specific policies representing internal compliance frameworks, project requirements, or environment-specific controls. Initiatives assigned at management group level cascade to all subscriptions and resources ensuring consistent compliance enforcement.

**Resource locks:**

Resource locks protect critical Azure resources from accidental deletion or modification providing defense-in-depth security control. **CanNotDelete locks** allow reading and updating resources while preventing deletion protecting production databases, virtual machines, networking resources, storage accounts from accidental removal. **ReadOnly locks** allow reading resources while preventing updates and deletion enforcing compliance-frozen configurations, reference architectures, or change control periods requiring approval processes. Locks inherit from parent scopes (management groups, subscriptions, resource groups) to child resources with most restrictive lock taking precedence. Lock removal requires appropriate permissions (Owner, User Access Administrator) with Azure role-based access control enforcing authorization. Organizations combine resource locks with Azure Policy using DeployIfNotExists policies automatically applying locks to newly created critical resources ensuring consistent protection. Lock management best practices include immediate locking of critical resources, documentation of lock purposes, regular lock reviews, and Infrastructure as Code integration with Bicep/Terraform templates.

**Microsoft Defender for Identity:**

Microsoft Defender for Identity provides identity threat detection for on-premises Active Directory environments monitoring authentication traffic, user activities, and domain controller events detecting credential theft, lateral movement, and domain dominance attacks. Lightweight sensors installed on domain controllers monitor Kerberos authentication, NTLM protocols, LDAP queries, and network activities without port mirroring or dedicated servers. Threat detection capabilities identify credential theft (Pass-the-Hash, Pass-the-Ticket, Golden Ticket, Silver Ticket attacks), reconnaissance (account enumeration, network mapping, directory services queries), lateral movement (remote execution via PsExec, WMI, PowerShell), and domain dominance (DCSync, DCShadow, skeleton key attacks). Security alerts categorized by MITRE ATT&CK framework tactics and techniques enable structured investigation workflows. Integration with Microsoft Defender XDR correlates identity alerts with endpoint, email, cloud app threats providing unified incident management and automated investigation. Advanced hunting with Kusto Query Language (KQL) enables proactive threat hunting across identity data. Organizations implement comprehensive sensor coverage on all domain controllers, enable advanced audit policies capturing detailed security events, and integrate alerts into Security Information and Event Management (SIEM) systems for correlation.

**GitHub Advanced Security integration:**

Microsoft Defender for DevOps bridges development and operations security integrating GitHub Advanced Security findings into Microsoft Defender for Cloud providing unified security visibility. Organizations onboard GitHub organizations to Defender for Cloud enabling Foundational CSPM for configuration security assessments and Defender CSPM for advanced DevOps posture management. GitHub connector synchronizes code scanning, secret scanning, and dependency scanning findings from GitHub to Defender for Cloud dashboards. Security recommendations span code vulnerabilities, exposed secrets, vulnerable dependencies, and repository configuration weaknesses (missing branch protection, disabled security features). Developers receive security feedback in GitHub pull requests while security operations teams monitor code-level risks alongside infrastructure vulnerabilities in centralized Defender portal. Microsoft Security DevOps command-line tool integrates open-source security scanners (Bandit, BinSkim, ESLint, Terrascan, Trivy) into GitHub Actions workflows with results appearing in both GitHub Security tab and Defender for Cloud. Organizations achieve end-to-end DevSecOps security with unified incident management, compliance reporting, and remediation workflows spanning source code through cloud infrastructure.

**GitHub Advanced Security configuration:**

GitHub Advanced Security provides comprehensive repository protection through code scanning, secret scanning, and dependency management. CodeQL code scanning uses semantic analysis treating code as queryable database detecting security vulnerabilities (SQL injection, cross-site scripting, insecure deserialization, authentication bypass) across multiple languages (C/C++, C#, Go, Java, JavaScript/TypeScript, Python, Ruby, Swift). Organizations configure GitHub Actions workflows running CodeQL on code pushes, pull requests, and scheduled scans with findings appearing in Security tab and pull request annotations. Secret scanning detects over 200 credential patterns including GitHub tokens, Azure connection strings, AWS access keys, database passwords with automatic partner notification for supported providers. Push protection blocks commits containing secrets before reaching repositories requiring developers removing credentials and storing securely in Azure Key Vault or GitHub Secrets. Dependabot dependency scanning monitors package manifests identifying vulnerable dependencies with known CVEs generating alerts and automatically creating pull requests updating to secure versions. Dependabot version updates keep dependencies current with scheduled updates configurable per package ecosystem (npm, pip, Maven, NuGet, Docker, GitHub Actions). Dependency review in pull requests displays impact of dependency changes showing added packages, removed packages, version updates, vulnerability information, and license compliance before merging preventing vulnerable dependencies entering codebase. Organizations implement branch protection requiring code scanning success, secret scanning clearance, and dependency review approval before merging enforcing security gates throughout development workflow.

## Integration and automation

Security monitoring and governance capabilities work synergistically creating comprehensive DevSecOps security posture. Azure Policy automatically deploys Microsoft Defender for Cloud agents and diagnostic settings to newly created resources. Resource locks protect policy assignments preventing unauthorized modifications. Defender for Cloud security recommendations trigger Azure Policy remediation tasks. Defender for Identity alerts correlate with Defender for Cloud endpoint and cloud resource threats in Microsoft Defender XDR incidents. GitHub Advanced Security findings synchronize to Defender for Cloud enabling security teams monitoring code vulnerabilities alongside infrastructure risks. Organizations automate security controls through Infrastructure as Code (IaC) defining policies, locks, Defender configurations, and GitHub Advanced Security settings in version-controlled Bicep/Terraform templates deployed through CI/CD pipelines. This automation ensures consistent security controls across environments with audit trails documenting all changes.

## Next steps

Organizations implementing security monitoring and governance should:

- **Conduct security assessment:** Evaluate current security posture identifying gaps in pipeline security, cloud workload protection, policy governance, identity monitoring, and code security.
- **Prioritize critical assets:** Identify critical resources requiring immediate protection through resource locks, Defender plans, and enhanced monitoring.
- **Implement policy-as-code:** Define security and compliance requirements as Azure Policy definitions deployed through CI/CD pipelines.
- **Enable Defender for Cloud:** Activate Foundational CSPM for all subscriptions and enable Defender plans for critical workloads starting with Servers and Containers.
- **Deploy Defender for Identity:** Install sensors on all domain controllers providing comprehensive identity threat detection coverage.
- **Integrate GitHub Advanced Security:** Onboard GitHub organizations to Defender for DevOps and configure CodeQL scanning, secret scanning, and Dependabot for all repositories.
- **Establish security workflows:** Define processes for alert triage, incident response, vulnerability remediation, and compliance reporting.
- **Train development and operations teams:** Provide training on security tools, secure coding practices, and DevSecOps workflows.
- **Measure and improve:** Track security metrics (Secure Score, policy compliance, finding remediation time) continuously improving security posture.

## Additional resources

- [Microsoft Defender for Cloud documentation](/azure/defender-for-cloud/).
- [Azure Policy documentation](/azure/governance/policy/).
- [Microsoft Defender for Identity documentation](/defender-for-identity/).
- [GitHub Advanced Security documentation](https://docs.github.com/en/code-security).
- [Microsoft Security DevOps](https://github.com/microsoft/security-devops-action).
- [Azure Well-Architected Framework - Security pillar](/azure/well-architected/security/).
- [DevSecOps on Azure](https://learn.microsoft.com/azure/architecture/solution-ideas/articles/devsecops-in-azure).
